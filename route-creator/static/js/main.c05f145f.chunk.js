(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{107:function(e,t,a){},109:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(46),s=a(5),i=a(6),l=a(9),c=a(7),u=a(8),d=a(32),m=a(21),p=a(3),h=(a(58),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.route,a=e.deleteRouteButton;return o.a.createElement("div",{className:"route"},o.a.createElement("div",null,t),a)}}]),t}(n.Component)),b=a(17),v=a(47),g=a.n(v),f=a(20),O=(a(68),function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(c.a)(t).call(this,e))).onBoundsChange=function(){a.setState({mapState:{center:a.state.map.getCenter()}})},a.instanceRef=function(e){a.setState({map:e})},a.onDragEnd=function(e){var t=e.destination,n=e.source;if(t&&(t.droppableId!==n.droppableId||t.index!==n.index)){var o=a.state.routes,r=a.state.multiRouteCoordinates,s=r.splice(n.index,1);r.splice(t.index,0,s[0]);var i=o.splice(n.index,1);o.splice(t.index,0,i[0]),a.setState(Object(m.a)({},a.state,{multiRouteCoordinates:r,routes:o})),a.updateYmapsElements()}},a.onApiAvaliable=function(e){a.setState({ymaps:e})},a.state={value:"",routes:[],mapState:{center:[55.75,37.57],zoom:9},multiRouteCoordinates:[],dragElems:[],routeFormPlaceholder:"enter point name"},a.handleChange=a.handleChange.bind(Object(p.a)(Object(p.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(p.a)(Object(p.a)(a))),a.updateYmapsElements=a.updateYmapsElements.bind(Object(p.a)(Object(p.a)(a))),a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"updateYmapsElements",value:function(){var e=this,t=this.state.ymaps,a=this.state.map,n=this.state.multiRouteCoordinates,o=this.state.routes;t.ready(["Map","multiRouter.MultiRoute","GeoObjectCollection","Polyline","GeoObject"]).then(function(){a.geoObjects.removeAll();var r=new t.multiRouter.MultiRoute({referencePoints:n});a.geoObjects.add(r);for(var s=0;s<o.length;s++){var i=new t.GeoObject(Object(m.a)({},o[s].geoObject.props),{preset:"islands#blackStretchyIcon",draggable:!0});a.geoObjects.add(i),a.geoObjects.events.add("dragend",function(r){var s=r.get("target"),i=s.geometry.getCoordinates(),l=s.properties._data.balloonContent;a.geoObjects.removeAll();for(var c=0;c<o.length;c++){l===o[c].value&&(n[c]=i,o[c].geoObject.props.geometry.coordinates=i,e.setState({routes:o,multiRouteCoordinates:n}));var u=new t.GeoObject(Object(m.a)({},o[c].geoObject.props),{preset:"islands#blackStretchyIcon",draggable:!0});a.geoObjects.add(u)}var d=new t.multiRouter.MultiRoute({referencePoints:n});a.geoObjects.add(d)})}})}},{key:"componentDidUpdate",value:function(e,t){this.state.routes!==t.routes&&(console.log("update",this.state.routes),this.updateYmapsElements())}},{key:"handleSubmit",value:function(e){if(this.state.value.length){var t=g.a.generate(),a=this.state.mapState.center,n=[this.state.value];this.setState({multiRouteCoordinates:Object(d.a)(this.state.multiRouteCoordinates).concat([a])}),this.setState({routes:Object(d.a)(this.state.routes).concat([{id:t,value:n,geoObject:o.a.createElement(b.GeoObject,{onClick:this.openBalloon.bind(this,this.state.value,a),key:t,objects:{openBalloonOnClick:!0},properties:{balloonContent:n},geometry:{type:"Point",coordinates:this.state.mapState.center}}),deleteRouteButton:[o.a.createElement("button",{key:t,onClick:this.deleteRoute.bind(this,t)},"x")]}])})}this.setState({value:""}),e.preventDefault()}},{key:"deleteRoute",value:function(e,t){var a=this,n=this.state.routes,o=this.state.multiRouteCoordinates;n.forEach(function(t,r){e===t.id&&(n.splice(r,1),o.splice(r,1),console.log(n),a.setState({routes:n,multiRouteCoordinates:o}))}),this.updateYmapsElements(),t.preventDefault()}},{key:"openBalloon",value:function(e,t,a){var n=[t[0]+.05,t[1]];a.originalEvent.map.balloon.setData(e),a.originalEvent.map.balloon.open(n)}},{key:"render",value:function(){var e=this.state.routes,t=e.map(function(e,t){return o.a.createElement(f.b,{draggableId:e.id,index:t},function(t){return o.a.createElement("li",Object.assign({},t.draggableProps,t.dragHandleProps,{ref:t.innerRef}),o.a.createElement(h,{key:e.id,deleteRouteButton:e.deleteRouteButton,route:e.value}))})}),a=e.map(function(e){return e.geoObject});return o.a.createElement("div",{className:"route-builder"},o.a.createElement("div",{className:"route-builder__menu"},o.a.createElement("form",{onSubmit:this.handleSubmit,className:"route-builder__form",id:"addRoute"},o.a.createElement("input",{type:"text",value:this.state.value,onChange:this.handleChange,name:"routeName",placeholder:this.routeFormPlaceholder}),o.a.createElement("button",null,"Add route")),o.a.createElement(f.a,{onDragEnd:this.onDragEnd},o.a.createElement(f.c,{droppableId:"0",index:"0"},function(e){return o.a.createElement("ul",Object.assign({},e.droppableProps,{ref:e.innerRef}),t.length?t:"No routes",e.placeholder)}))),o.a.createElement(b.YMaps,null,o.a.createElement("div",null,o.a.createElement("div",{className:"yandex-map"},o.a.createElement(b.Map,{onLoad:this.onApiAvaliable,defaultState:this.state.mapState,instanceRef:this.instanceRef,onBoundsChange:this.onBoundsChange,width:"inherit",height:"inherit"},a),o.a.createElement("div",{className:"yandex-map__center"},o.a.createElement("div",{className:"top"}),o.a.createElement("div",{className:"bottom"}),o.a.createElement("div",{className:"left"}),o.a.createElement("div",{className:"right"}))),o.a.createElement("div",{className:"yandex-map__text-center"},"Map center: ",JSON.stringify(this.state.mapState.center)))))}}]),t}(n.Component)),j=(a(107),a(52)),E=a.n(j),y=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"content__title"},o.a.createElement("h1",null,"Route creator"),o.a.createElement("img",{className:"content__logo",src:E.a})),o.a.createElement(O,null))}}]),t}(n.Component);Object(r.render)(o.a.createElement(y,null),document.getElementById("root"))},52:function(e,t,a){e.exports=a.p+"static/media/marker.f9217e21.png"},53:function(e,t,a){e.exports=a(109)},58:function(e,t,a){},68:function(e,t,a){}},[[53,2,1]]]);
//# sourceMappingURL=main.c05f145f.chunk.js.map